SELECT h.host AS hostname, i.ip AS ip_address, g.name AS host_group, CASE WHEN i.type = 1 THEN 'Agent' WHEN i.type = 2 THEN 'SNMP' WHEN i.type = 3 THEN 'IPMI' WHEN i.type = 4 THEN 'JMX' ELSE 'Unknown' END AS agent_type, CASE WHEN h.status = 0 THEN 'Enabled' ELSE 'Disabled' END AS host_status FROM hosts h JOIN interface i ON h.hostid = i.hostid JOIN hosts_groups hg ON h.hostid = hg.hostid JOIN hstgrp g ON hg.groupid = g.groupid WHERE g.name in  ('SPR-SD-Network','HCM-BD-Network','HNI-BD-Network','SDY-SD-Network','DJK-BD-Network','NDL-BD-Network','ULN-BD-Network','BBY-BD-Network')  ORDER BY h.hostid, i.interfaceid;


SELECT h.host AS hostname, i.ip AS ip_address, g.name AS host_group, CASE WHEN i.type = 1 THEN 'Agent' WHEN i.type = 2 THEN 'SNMP' WHEN i.type = 3 THEN 'IPMI' WHEN i.type = 4 THEN 'JMX' ELSE 'Unknown' END AS agent_type, CASE WHEN h.status = 0 THEN 'Enabled' ELSE 'Disabled' END AS host_status, COALESCE(MAX(CASE WHEN p.severity IS NOT NULL THEN 'Problem' ELSE NULL END), 'No issues') AS error_status, GROUP_CONCAT(DISTINCT p.name SEPARATOR ', ') AS problem_names FROM hosts h JOIN interface i ON h.hostid = i.hostid JOIN hosts_groups hg ON h.hostid = hg.hostid JOIN hstgrp g ON hg.groupid = g.groupid LEFT JOIN items itm ON h.hostid = itm.hostid LEFT JOIN problem p ON p.source = 0 AND p.object = 0 AND p.objectid = itm.itemid AND p.r_eventid IS NULL WHERE g.name IN ('SPR-SD-Network','HCM-BD-Network','HNI-BD-Network','SDY-SD-Network','DJK-BD-Network','NDL-BD-Network','ULN-BD-Network','BBY-BD-Network') GROUP BY h.host, i.ip, g.name, i.type, h.status ORDER BY h.hostid, i.interfaceid;